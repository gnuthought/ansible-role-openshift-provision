---
- hosts: localhost
  connection: local
  roles:
  - role: openshift-provision
  vars_files:
  - login-creds.yml
  vars:
    provision_persistentvolumeclaim: >-
      {{ lookup('template', 'resources/test-persistentvolumeclaim-minimal.yml.j2')
       | from_yaml }}
    persistentvolumeclaim_labels:
      testlabel: bar
  tasks:
  - name: Login to OpenShift Cluster
    openshift_login:
      username: "{{ openshift_test_login_username }}"
      password: "{{ openshift_test_login_password }}"
      server: "{{ openshift_connection_server }}"
      insecure_skip_tls_verify: "true"
    register: openshift_login

  - name: Test Provision
    openshift_provision:
      connection: "{{ openshift_login.session }}"
      namespace: provision-test
      resource: "{{ provision_persistentvolumeclaim }}"
